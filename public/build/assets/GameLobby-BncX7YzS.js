import{r as c,j as e,H as y}from"./app-DO5pDGxG.js";import{F as N,n as u}from"./index-lpUd8fhw.js";const f=["bg-gradient-to-br from-cyan-400 to-cyan-600 text-slate-900","bg-gradient-to-br from-emerald-500 to-teal-400 text-white","bg-gradient-to-br from-indigo-600 to-blue-400 text-white","bg-gradient-to-br from-amber-400 to-orange-500 text-slate-900","bg-gradient-to-br from-rose-500 to-pink-400 text-white","bg-gradient-to-br from-slate-800 to-slate-600 text-white","bg-gradient-to-br from-lime-400 to-green-500 text-slate-900","bg-gradient-to-br from-purple-600 to-fuchsia-400 text-white"],k=l=>{let a=0;for(let r=0;r<l.length;r+=1)a=(a<<5)-a+l.charCodeAt(r),a|=0;return a};function V({gameSlug:l,players:a=[],voiceUrl:r}){const[o,m]=c.useState(null),[s,h]=c.useState(null),[w,x]=c.useState(!1),p=async t=>{if(t.hasViewed){u.error("This card has already been revealed.");return}x(!0);try{const i=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",g=await fetch(`/games/${l}/reveal/${t.id}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":i,Accept:"application/json"}});if(!g.ok)throw new Error("Failed to reveal card.");const j=await g.json();m(t),h(j);const C=a.map(d=>d.id===t.id?{...d,hasViewed:!0}:d)}catch(i){u.error(i.message||"Something went wrong.")}finally{x(!1)}},b=()=>{m(null),h(null)},v=o?f[Math.abs(k(o.name||""))%f.length]:"",n=s?s.alreadyViewed?{title:"Card already revealed",body:"This card was already viewed."}:s.isImposter?{title:"You are the Imposter!",body:"Bluff your way through the round."}:{title:"Your Secret Word",body:s.word}:null;return e.jsxs(e.Fragment,{children:[e.jsx(y,{children:e.jsx("title",{children:"Game Lobby - Pakistani Imposter Game"})}),e.jsx(N,{position:"top-center"}),e.jsx("div",{className:"min-h-screen w-full bg-gradient-to-br from-slate-100 to-slate-200 flex flex-col items-center px-4 py-10",children:e.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-3xl p-8 shadow-2xl text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Game Lobby"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Click your name to reveal your card. Keep it secret!"}),r&&e.jsx("div",{className:"mb-6",children:e.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"inline-block rounded-xl bg-emerald-500 px-5 py-3 text-white font-semibold shadow-md shadow-emerald-200/70 hover:bg-emerald-600",children:"Join group voice chat"})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 mb-8",children:a.map(t=>e.jsxs("button",{onClick:()=>p(t),disabled:t.hasViewed||w,className:`rounded-2xl border-2 px-6 py-8 text-lg font-semibold transition shadow-sm ${t.hasViewed?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-gradient-to-br from-pink-400 to-rose-400 text-white border-pink-500 hover:shadow-lg hover:-translate-y-1 cursor-pointer"}`,children:[t.name,t.hasViewed&&e.jsx("div",{className:"text-sm mt-1 font-normal",children:"Already revealed"})]},t.id))}),o&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:b,children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-lg w-full shadow-2xl",onClick:t=>t.stopPropagation(),children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:["Hi, ",o.name]}),e.jsx("div",{className:"relative w-full h-72 mx-auto my-6 [perspective:1100px] select-none",children:e.jsxs("div",{className:`relative w-full h-full rounded-3xl shadow-2xl flex flex-col items-center justify-center px-6 text-center ${v}`,children:[e.jsx("div",{className:"text-2xl font-bold mb-3",children:n.title}),e.jsx("div",{className:"text-lg whitespace-pre-line",children:n.body})]})}),e.jsx("div",{className:"text-sm text-slate-500 mb-4",children:!s.alreadyViewed&&"Remember your card! You can't view it again."}),e.jsx("button",{className:"w-full rounded-xl bg-pink-500 px-6 py-3 text-white font-semibold shadow-md hover:bg-pink-600",onClick:b,children:"Close"})]})}),e.jsx("div",{className:"text-sm text-slate-500 mt-8",children:"Share this page's URL with all players to let them reveal their cards."})]})})]})}export{V as default};
